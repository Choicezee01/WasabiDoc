<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PayJoin | Wasabi Docs</title>
    <meta name="description" content="A detailed explanation about PayJoin and it&#39;s implementation in Wasabi Wallet. This is the Wasabi documentation, an archive of knowledge about the open-source, non-custodial and privacy-focused Bitcoin wallet for desktop.">
    <meta name="generator" content="VuePress 1.3.1">
    <link rel="icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#211b24">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata:400,700|Playfair+Display:700&amp;display=swap">
  <meta name="msapplication-TileColor" content="#211b24">
  <meta name="theme-color" content="#211b24">
    
    <link rel="preload" href="/assets/css/0.styles.b6becbd2.css" as="style"><link rel="preload" href="/assets/js/app.cfd22a61.js" as="script"><link rel="preload" href="/assets/js/3.665a2e13.js" as="script"><link rel="preload" href="/assets/js/44.d22b1010.js" as="script"><link rel="prefetch" href="/assets/js/10.268790de.js"><link rel="prefetch" href="/assets/js/11.a67c25b5.js"><link rel="prefetch" href="/assets/js/12.e41086f2.js"><link rel="prefetch" href="/assets/js/13.6ffd72ed.js"><link rel="prefetch" href="/assets/js/14.49fcf05d.js"><link rel="prefetch" href="/assets/js/15.d9183e5d.js"><link rel="prefetch" href="/assets/js/16.609907aa.js"><link rel="prefetch" href="/assets/js/17.2b5e29a8.js"><link rel="prefetch" href="/assets/js/18.d589b8f1.js"><link rel="prefetch" href="/assets/js/19.554b4a50.js"><link rel="prefetch" href="/assets/js/20.b0377a9a.js"><link rel="prefetch" href="/assets/js/21.200103fd.js"><link rel="prefetch" href="/assets/js/22.5244b742.js"><link rel="prefetch" href="/assets/js/23.914f9221.js"><link rel="prefetch" href="/assets/js/24.fc934220.js"><link rel="prefetch" href="/assets/js/25.943ad0d1.js"><link rel="prefetch" href="/assets/js/26.c4b98968.js"><link rel="prefetch" href="/assets/js/27.c7a345b7.js"><link rel="prefetch" href="/assets/js/28.6865230e.js"><link rel="prefetch" href="/assets/js/29.1219c9d2.js"><link rel="prefetch" href="/assets/js/30.0a5299ea.js"><link rel="prefetch" href="/assets/js/31.1fca683c.js"><link rel="prefetch" href="/assets/js/32.04d1a0d2.js"><link rel="prefetch" href="/assets/js/33.5cb20544.js"><link rel="prefetch" href="/assets/js/34.d4cd20b0.js"><link rel="prefetch" href="/assets/js/35.06e2dda5.js"><link rel="prefetch" href="/assets/js/36.72e1cdaa.js"><link rel="prefetch" href="/assets/js/37.d6eb19f5.js"><link rel="prefetch" href="/assets/js/38.d935e822.js"><link rel="prefetch" href="/assets/js/39.ea0bd67e.js"><link rel="prefetch" href="/assets/js/4.111fa0c7.js"><link rel="prefetch" href="/assets/js/40.ffbc02c4.js"><link rel="prefetch" href="/assets/js/41.3dd649fb.js"><link rel="prefetch" href="/assets/js/42.7b9d9fe8.js"><link rel="prefetch" href="/assets/js/43.ef05739a.js"><link rel="prefetch" href="/assets/js/45.132f0b44.js"><link rel="prefetch" href="/assets/js/46.1495a179.js"><link rel="prefetch" href="/assets/js/47.0b349802.js"><link rel="prefetch" href="/assets/js/48.e6bbec9f.js"><link rel="prefetch" href="/assets/js/49.2a323e2c.js"><link rel="prefetch" href="/assets/js/5.b674608a.js"><link rel="prefetch" href="/assets/js/50.04d52050.js"><link rel="prefetch" href="/assets/js/51.1a9f8152.js"><link rel="prefetch" href="/assets/js/52.83c3d1dd.js"><link rel="prefetch" href="/assets/js/53.0dbcd978.js"><link rel="prefetch" href="/assets/js/54.6fc1897c.js"><link rel="prefetch" href="/assets/js/55.7fc1caa6.js"><link rel="prefetch" href="/assets/js/56.d396ab14.js"><link rel="prefetch" href="/assets/js/57.e7759fc4.js"><link rel="prefetch" href="/assets/js/58.2cac7ebc.js"><link rel="prefetch" href="/assets/js/59.bc8d37e1.js"><link rel="prefetch" href="/assets/js/6.53958b5c.js"><link rel="prefetch" href="/assets/js/60.58751dc5.js"><link rel="prefetch" href="/assets/js/61.400a3d47.js"><link rel="prefetch" href="/assets/js/62.bae5280a.js"><link rel="prefetch" href="/assets/js/63.5893fae3.js"><link rel="prefetch" href="/assets/js/64.f5055975.js"><link rel="prefetch" href="/assets/js/65.54a3eda5.js"><link rel="prefetch" href="/assets/js/66.cb622353.js"><link rel="prefetch" href="/assets/js/7.7408ca24.js"><link rel="prefetch" href="/assets/js/8.5022cbf1.js"><link rel="prefetch" href="/assets/js/9.798ab4f3.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.a56604f5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b6becbd2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/Logo_without_text.png" alt="Wasabi Docs" class="logo"> <span class="site-name can-hide">Wasabi Docs</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/why-wasabi/" class="nav-link">
  Why Wasabi
</a></div><div class="nav-item"><a href="/using-wasabi/" class="nav-link router-link-active">
  Using Wasabi
</a></div><div class="nav-item"><a href="/building-wasabi/" class="nav-link">
  Building Wasabi
</a></div><div class="nav-item"><a href="/FAQ/" class="nav-link">
  FAQ
</a></div><div class="nav-item"><a href="/glossary/" class="nav-link">
  Glossary
</a></div> <a href="https://github.com/zkSNACKs/WasabiDoc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/why-wasabi/" class="nav-link">
  Why Wasabi
</a></div><div class="nav-item"><a href="/using-wasabi/" class="nav-link router-link-active">
  Using Wasabi
</a></div><div class="nav-item"><a href="/building-wasabi/" class="nav-link">
  Building Wasabi
</a></div><div class="nav-item"><a href="/FAQ/" class="nav-link">
  FAQ
</a></div><div class="nav-item"><a href="/glossary/" class="nav-link">
  Glossary
</a></div> <a href="https://github.com/zkSNACKs/WasabiDoc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Introducing Wasabi</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/using-wasabi/ELI5.html" class="sidebar-link">Explain Wasabi like I'm 5</a></li><li><a href="/using-wasabi/10Commandments.html" class="sidebar-link">Ten Commandments</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Installing Wasabi</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/using-wasabi/InstallPackage.html" class="sidebar-link">Install-package</a></li><li><a href="/using-wasabi/BuildSource.html" class="sidebar-link">Build from source code</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Using Wasabi</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/using-wasabi/WalletGeneration.html" class="sidebar-link">Wallet Generation</a></li><li><a href="/using-wasabi/WalletLoad.html" class="sidebar-link">Wallet Load</a></li><li><a href="/using-wasabi/Receive.html" class="sidebar-link">Receive</a></li><li><a href="/using-wasabi/CoinJoin.html" class="sidebar-link">CoinJoin</a></li><li><a href="/using-wasabi/Send.html" class="sidebar-link">Send</a></li><li><a href="/using-wasabi/ColdWasabi.html" class="sidebar-link">Cold-Wasabi Hardware Wallet Mode</a></li><li><a href="/using-wasabi/BitcoinFullNode.html" class="sidebar-link">Bitcoin Full Node</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Best Practices</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/using-wasabi/PasswordBestPractices.html" class="sidebar-link">Password Best Practices</a></li><li><a href="/using-wasabi/BackupBestPractices.html" class="sidebar-link">Backup Best Practices</a></li><li><a href="/using-wasabi/ChangeCoins.html" class="sidebar-link">Change Coins</a></li><li><a href="/using-wasabi/Deanonimization.html" class="sidebar-link">How you can be de-anonymized using Bitcoin</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Restoring Wasabi</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/using-wasabi/WalletRecovery.html" class="sidebar-link">Recover a Wallet</a></li><li><a href="/using-wasabi/RestoreElectrum.html" class="sidebar-link">Restoring Wasabi Wallet in Electrum</a></li><li><a href="/using-wasabi/PasswordFinder.html" class="sidebar-link">Password Finder</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Advanced Installing Wasabi</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/using-wasabi/DeterministicBuild.html" class="sidebar-link">Deterministic Build</a></li><li><a href="/using-wasabi/WasabiSetupTails.html" class="sidebar-link">Wasabi Setup on Tails</a></li><li><a href="/using-wasabi/WasabiSetupVM.html" class="sidebar-link">Wasabi Setup in Virtual Machines</a></li><li><a href="/using-wasabi/WasabiSetupWhonix.html" class="sidebar-link">Wasabi Setup using Whonix</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Advanced Using Wasabi</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/using-wasabi/Daemon.html" class="sidebar-link">Headless Wasabi Daemon</a></li><li><a href="/using-wasabi/RPC.html" class="sidebar-link">RPC Interface</a></li><li><a href="/using-wasabi/LurkingWifeMode.html" class="sidebar-link">Lurking Wife Mode</a></li><li><a href="/using-wasabi/PayJoin.html" class="active sidebar-link">PayJoin</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/using-wasabi/PayJoin.html#sending-payjoin-step-by-step" class="sidebar-link">Sending PayJoin step-by-step</a></li><li class="sidebar-sub-header"><a href="/using-wasabi/PayJoin.html#the-goal-of-payjoin" class="sidebar-link">The goal of PayJoin</a></li><li class="sidebar-sub-header"><a href="/using-wasabi/PayJoin.html#coordination" class="sidebar-link">Coordination</a></li><li class="sidebar-sub-header"><a href="/using-wasabi/PayJoin.html#fallback-transaction" class="sidebar-link">Fallback transaction</a></li><li class="sidebar-sub-header"><a href="/using-wasabi/PayJoin.html#payjoin-transaction" class="sidebar-link">PayJoin transaction</a></li><li class="sidebar-sub-header"><a href="/using-wasabi/PayJoin.html#advantages-of-payjoin" class="sidebar-link">Advantages of PayJoin</a></li></ul></li><li><a href="/using-wasabi/Testnet.html" class="sidebar-link">Testnet</a></li><li><a href="/using-wasabi/LockScreen.html" class="sidebar-link">Lock Screen</a></li><li><a href="/using-wasabi/BIPs.html" class="sidebar-link">Supported BIPs</a></li><li><a href="/using-wasabi/IndustryStandards.html" class="sidebar-link">Supported Industry Standards</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="payjoin"><a href="#payjoin" class="header-anchor">#</a> PayJoin</h1> <p></p><div class="table-of-contents"><ul><li><a href="#sending-payjoin-step-by-step">Sending PayJoin step-by-step</a></li><li><a href="#the-goal-of-payjoin">The goal of PayJoin</a></li><li><a href="#coordination">Coordination</a></li><li><a href="#fallback-transaction">Fallback transaction</a></li><li><a href="#payjoin-transaction">PayJoin transaction</a></li><li><a href="#advantages-of-payjoin">Advantages of PayJoin</a></li></ul></div><p></p> <hr> <h2 id="sending-payjoin-step-by-step"><a href="#sending-payjoin-step-by-step" class="header-anchor">#</a> Sending PayJoin step-by-step</h2> <ol><li><p>Load a wallet and open the <code>Send</code> tab.</p></li> <li><p>Request from the receiver a <a href="/using-wasabi/BIPs.html#bip-21-uri-scheme">BIP21 Bitcoin URI</a> with the flag <code>pj=</code> and paste it into the address field of the <code>Send</code> tab.</p></li> <li><p>Select the coins you want to send.</p></li> <li><p>Verify the information is correct, type in the password, and press <code>Send</code>.</p></li></ol> <p><img src="/PayJoinSend.png" alt=""></p> <h2 id="the-goal-of-payjoin"><a href="#the-goal-of-payjoin" class="header-anchor">#</a> The goal of PayJoin</h2> <p>PayJoin is a collaborative transaction between the sender and the receiver of a payment, for example the merchant and the customer.
The goal of the protocol is to break the common input ownership heuristic, while making it difficult to fingerprint that the transaction is in fact a CoinJoin.
Further, it reduces the transaction fees paid by the merchant due to consolidation of coins.</p> <p>Wasabi diverges from <a href="https://github.com/bitcoin/bips/blob/master/bip-0079.mediawiki" target="_blank" rel="noopener noreferrer">the initial BIP 79 Bustapay proposal<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, the details of the implemented specification are <a href="https://docs.btcpayserver.org/features/payjoin/payjoin-spec" target="_blank" rel="noopener noreferrer">documented here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h2 id="coordination"><a href="#coordination" class="header-anchor">#</a> Coordination</h2> <p>The coordination of this CoinJoin is done with the PayToEndPoint [P2EP] concept.
The receiver is reachable over the internet, either over a Tor hidden service or clearnet IP address.
The link is included in a BIP21 Bitcoin URI, and is provided to the sender as the payment invoice.
The sender uses this hidden service or IP address to connect to the server of the receiver and communicate the further protocol.
The coordination is usually done within seconds, and will abort to the fallback transaction after some time if the connection breaks.</p> <h2 id="fallback-transaction"><a href="#fallback-transaction" class="header-anchor">#</a> Fallback transaction</h2> <p>In the very first request to the receiving server, the sender provides a finalized signed transaction which has only the inputs of the sender, like any other Bitcoin transaction.
The inputs are only from the sender.
The outputs are the address of the receiver, as well as the change address of the sender.
For example here, Alice pays Bob <code>0.2 bitcoin</code>.</p> <div class="language- extra-class"><pre class="language-text"><code>Alice input   1 bitcoin   --&gt;   Bob output            0.2 bitcoin
                                Alice change output   0.8 bitcoin
</code></pre></div><p>Both the sender and the receiver <em>could</em> broadcast this transaction.</p> <h2 id="payjoin-transaction"><a href="#payjoin-transaction" class="header-anchor">#</a> PayJoin transaction</h2> <p>The receiving server responds to this initial proposal, with a transaction that adds more inputs to the transaction.
Thus, the output belonging to the receiver increases in value, above the value that the payment amount is due.</p> <div class="language- extra-class"><pre class="language-text"><code>Alice input   1 bitcoin   --&gt;   Bob output            0.7 bitcoin
Bob input     0.5 bitcoin --&gt;   Alice change output   0.8 bitcoin
</code></pre></div><p>The sender broadcasts this transaction to the Bitcoin network.</p> <h2 id="advantages-of-payjoin"><a href="#advantages-of-payjoin" class="header-anchor">#</a> Advantages of PayJoin</h2> <p>First and foremost, the common input ownership heuristic is broken, meaning that the inputs do not belong to one single entity, but to several of them.
This breaks one of the most important assumptions of transaction surveillance companies.
Contrarily to other CoinJoin implementations, the outputs are not of equal value, so it is not obvious that this transaction is in fact a CoinJoin.</p> <p>Further, the outputs do not reflect the actual value of the transaction.
In our example, the economic transfer is of <code>0.2 bitcoin</code> from Alice to Bob, but the outputs are worth <code>0.7 bitcoin</code> and <code>0.8 bitcoin</code>.
This is obfuscating the actual amount payed.</p> <p>Finally, the receiver is consolidating his coins, thus saving on future transaction fees.
Without the PayJoin, the receiver would have two coins, worth <code>0.2 bitcoin</code> and <code>0.5 bitcoin</code>, and he would have to pay twice the transaction fee to spend these coins.
But because of using PayJoin, he only has one coin, worth <code>0.7 bitcoin</code>, thus reducing his future transaction costs when spending this coin.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/zkSNACKs/WasabiDoc/edit/master/docs/using-wasabi/PayJoin.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/10/2020, 9:14:07 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/using-wasabi/LurkingWifeMode.html" class="prev">
        Lurking Wife Mode
      </a></span> <span class="next"><a href="/using-wasabi/Testnet.html">
        Testnet
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.cfd22a61.js" defer></script><script src="/assets/js/3.665a2e13.js" defer></script><script src="/assets/js/44.d22b1010.js" defer></script>
  </body>
</html>
